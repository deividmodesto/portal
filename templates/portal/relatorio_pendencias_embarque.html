{% load static %}
{% load l10n %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Pendências de Embarque</title>
    <style>
        body { font-family: sans-serif; margin: 20px; color: #333; }
        .report-header { text-align: center; border-bottom: 2px solid #ccc; padding-bottom: 15px; margin-bottom: 30px; }
        .report-header img { max-height: 60px; margin-bottom: 10px; }
        h1 { font-weight: normal; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; vertical-align: middle; }
        th { background-color: #e9ecef; }
        td.numero { text-align: center; }
        @media print {
            .no-print { display: none; }
        }
        .print-button { position: fixed; top: 20px; right: 20px; padding: 10px 20px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <button onclick="window.print();" class="print-button no-print">Imprimir</button>

    <div class="report-header">
        <img src="{% static 'img/logo_reunidas2.png' %}" alt="Logo Reunidas">
        <h1>Relatório de Pendências de Embarque</h1>
        {% if data_inicio and data_fim %}
            <p>Período de Disponibilidade: de <strong>{{ data_inicio|date:"d/m/Y" }}</strong> até <strong>{{ data_fim|date:"d/m/Y" }}</strong></p>
        {% else %}
            <p>Exibindo todas as coletas pendentes.</p>
        {% endif %}
    </div>

    <table>
        <thead>
            <tr>
                <th>Data de Disponibilidade</th>
                <th>Fornecedor</th>
                <th>Pedido</th>
                <th class="numero">Volumes</th>
                <th class="numero">Peso (Kg)</th>
            </tr>
        </thead>
        <tbody>
            {% for coleta in coletas_pendentes %}
            <tr>
                <td>{{ coleta.data_disponibilidade|date:"d/m/Y" }}</td>
                <td>
                    {% if coleta.pedido_liberado %}
                        {{ coleta.pedido_liberado.fornecedor_usuario.nome_fornecedor }}
                    {% else %}
                        {{ coleta.fornecedor_avulso }}
                    {% endif %}
                </td>
                <td>{{ coleta.pedido_liberado.numero_pedido|default:"AVULSO" }}</td>
                <td class="numero">{{ coleta.volumes|default_if_none:"-" }}</td>
                <td class="numero">{{ coleta.peso_kg|localize|default_if_none:"-" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="text-align: center; padding: 2em;">Nenhuma pendência de embarque encontrada para os filtros selecionados.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>